{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "volume-control",
  "dependencies": [
    "@base-ui-components/react"
  ],
  "registryDependencies": [
    "https://limeplay.winoffrg.dev/r/media-provider.json",
    "https://limeplay.winoffrg.dev/r/utils.json",
    "https://limeplay.winoffrg.dev/r/use-volume.json",
    "https://limeplay.winoffrg.dev/r/use-track-events.json",
    "https://limeplay.winoffrg.dev/r/use-player.json"
  ],
  "files": [
    {
      "path": "registry/default/ui/volume-control.tsx",
      "content": "\"use client\"\n\nimport { Slider as SliderPrimitive } from \"@base-ui-components/react/slider\"\nimport React, { useImperativeHandle, useRef, useState } from \"react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { MediaReadyState } from \"@/registry/default/hooks/use-player\"\nimport { useTrackEvents } from \"@/registry/default/hooks/use-track-events\"\nimport { useVolume } from \"@/registry/default/hooks/use-volume\"\nimport { useMediaStore } from \"@/registry/default/ui/media-provider\"\n\nconst VOLUME_RESET_BASE = 0.05\n\nexport type VolumeRootPropsDocs = Pick<\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>,\n  \"disabled\" | \"orientation\"\n>\n\nexport const Root = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>((props, ref) => {\n  const internalRef = useRef<HTMLDivElement>(\n    null\n  ) as React.RefObject<HTMLDivElement>\n  const { className, orientation = \"horizontal\", ...etc } = props\n  const volume = useMediaStore((state) => state.volume)\n  const hasAudio = useMediaStore((state) => state.hasAudio)\n  const muted = useMediaStore((state) => state.muted)\n  const readyState = useMediaStore((state) => state.readyState)\n  const [currentValue, setCurrentValue] = useState(volume)\n\n  const disabled = props.disabled || readyState < MediaReadyState.HAVE_METADATA\n\n  useImperativeHandle(ref, () => internalRef.current)\n  const { setVolume } = useVolume()\n\n  const getVolumeFromEvent = (event: React.PointerEvent) => {\n    const rect = event.currentTarget.getBoundingClientRect()\n    let percentage: number\n\n    if (orientation === \"vertical\") {\n      percentage = 1 - (event.clientY - rect.top) / rect.height\n    } else {\n      percentage = (event.clientX - rect.left) / rect.width\n    }\n\n    return Math.max(0, Math.min(1, percentage))\n  }\n\n  const trackEvents = useTrackEvents({\n    onPointerDown: (progress, event) => {\n      if (disabled) return\n      const newVolume = getVolumeFromEvent(event)\n      setCurrentValue(newVolume)\n      setVolume(newVolume)\n    },\n    onPointerMove: (progress, isPointerDown, event) => {\n      if (disabled) return\n      if (isPointerDown) {\n        const newVolume = getVolumeFromEvent(event)\n        setCurrentValue(newVolume)\n        setVolume(newVolume)\n      }\n    },\n    orientation,\n  })\n\n  if (!hasAudio) {\n    return null\n  }\n\n  const currentVolumeValue = muted\n    ? 0\n    : currentValue === 0\n      ? VOLUME_RESET_BASE\n      : volume\n\n  return (\n    <SliderPrimitive.Root\n      className={cn(\n        \"relative flex touch-none items-center justify-center select-none\",\n        className\n      )}\n      max={1}\n      min={0}\n      orientation={orientation}\n      ref={internalRef}\n      step={0.01}\n      value={[currentVolumeValue]}\n      {...trackEvents}\n      {...etc}\n      disabled={disabled}\n    />\n  )\n})\n\nRoot.displayName = \"VolumeRoot\"\n\nexport const Track = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Track>\n>((props, ref) => {\n  const { className, ...etc } = props\n\n  return (\n    <SliderPrimitive.Track\n      className={cn(\n        \"relative size-full overflow-hidden rounded-md bg-primary/30\",\n        className\n      )}\n      ref={ref}\n      {...etc}\n    />\n  )\n})\n\nTrack.displayName = \"VolumeTrack\"\n\nexport const Progress = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Track>\n>((props, ref) => {\n  const { className, ...etc } = props\n  const volume = useMediaStore((state) => state.volume)\n  const muted = useMediaStore((state) => state.muted)\n  const currentValue = muted ? 0 : volume\n\n  return (\n    <SliderPrimitive.Indicator\n      className={cn(\n        `\n          h-full w-(--lp-volume-value) bg-primary\n          data-disabled:bg-primary/20\n        `,\n        \"data-[orientation=vertical]:h-(--lp-volume-value) data-[orientation=vertical]:w-full\",\n        className\n      )}\n      ref={ref}\n      style={\n        {\n          \"--lp-volume-value\": `${(currentValue * 100).toString()}%`,\n        } as React.CSSProperties\n      }\n      {...etc}\n    />\n  )\n})\n\nProgress.displayName = \"VolumeProgress\"\n\nexport type VolumeThumbPropsDocs = Pick<ThumbProps, \"showVolumeText\">\n\ninterface ThumbProps\n  extends React.ComponentPropsWithoutRef<typeof SliderPrimitive.Thumb> {\n  /**\n   * Whether to show volume percentage as aria text\n   * @default true\n   */\n  showVolumeText?: boolean\n}\n\nexport const Thumb = React.forwardRef<HTMLDivElement, ThumbProps>(\n  (props, ref) => {\n    const { className, showVolumeText = true, ...etc } = props\n    const volume = useMediaStore((state) => state.volume)\n    const displayValue = Number((volume * 100).toFixed(2))\n\n    return (\n      <SliderPrimitive.Thumb\n        aria-label=\"Volume\"\n        aria-valuemax={100}\n        aria-valuemin={0}\n        aria-valuenow={displayValue}\n        aria-valuetext={\n          showVolumeText ? `${displayValue.toString()}% volume` : undefined\n        }\n        className={cn(\n          `\n            block size-2 rounded-full bg-primary\n            focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary/50\n            data-disabled:bg-primary/85\n          `,\n          className\n        )}\n        ref={ref}\n        {...etc}\n      />\n    )\n  }\n)\n\nThumb.displayName = \"VolumeThumb\"\n",
      "type": "registry:ui",
      "target": "components/limeplay/volume-control.tsx"
    }
  ],
  "type": "registry:ui"
}