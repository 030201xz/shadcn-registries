{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "tool-fallback",
  "type": "registry:component",
  "files": [
    {
      "content": "\"use client\";\n\nimport { memo, useCallback, useRef, useState } from \"react\";\nimport {\n  AlertCircleIcon,\n  CheckIcon,\n  ChevronDownIcon,\n  LoaderIcon,\n  XCircleIcon,\n} from \"lucide-react\";\nimport {\n  useScrollLock,\n  type ToolCallMessagePartStatus,\n  type ToolCallMessagePartComponent,\n} from \"@assistant-ui/react\";\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"@/components/ui/collapsible\";\nimport { cn } from \"@/lib/utils\";\n\nconst ANIMATION_DURATION = 200;\n\nexport type ToolFallbackRootProps = Omit<\n  React.ComponentProps<typeof Collapsible>,\n  \"open\" | \"onOpenChange\"\n> & {\n  open?: boolean;\n  onOpenChange?: (open: boolean) => void;\n  defaultOpen?: boolean;\n};\n\nfunction ToolFallbackRoot({\n  className,\n  open: controlledOpen,\n  onOpenChange: controlledOnOpenChange,\n  defaultOpen = false,\n  children,\n  ...props\n}: ToolFallbackRootProps) {\n  const collapsibleRef = useRef<HTMLDivElement>(null);\n  const [uncontrolledOpen, setUncontrolledOpen] = useState(defaultOpen);\n  const lockScroll = useScrollLock(collapsibleRef, ANIMATION_DURATION);\n\n  const isControlled = controlledOpen !== undefined;\n  const isOpen = isControlled ? controlledOpen : uncontrolledOpen;\n\n  const handleOpenChange = useCallback(\n    (open: boolean) => {\n      if (!open) {\n        lockScroll();\n      }\n      if (!isControlled) {\n        setUncontrolledOpen(open);\n      }\n      controlledOnOpenChange?.(open);\n    },\n    [lockScroll, isControlled, controlledOnOpenChange],\n  );\n\n  return (\n    <Collapsible\n      ref={collapsibleRef}\n      data-slot=\"tool-fallback-root\"\n      open={isOpen}\n      onOpenChange={handleOpenChange}\n      className={cn(\n        \"aui-tool-fallback-root group/tool-fallback-root w-full rounded-lg border py-3\",\n        className,\n      )}\n      style={\n        {\n          \"--animation-duration\": `${ANIMATION_DURATION}ms`,\n        } as React.CSSProperties\n      }\n      {...props}\n    >\n      {children}\n    </Collapsible>\n  );\n}\n\ntype ToolStatus = ToolCallMessagePartStatus[\"type\"];\n\nconst statusIconMap: Record<ToolStatus, React.ElementType> = {\n  running: LoaderIcon,\n  complete: CheckIcon,\n  incomplete: XCircleIcon,\n  \"requires-action\": AlertCircleIcon,\n};\n\nfunction ToolFallbackTrigger({\n  toolName,\n  status,\n  className,\n  ...props\n}: React.ComponentProps<typeof CollapsibleTrigger> & {\n  toolName: string;\n  status?: ToolCallMessagePartStatus;\n}) {\n  const statusType = status?.type ?? \"complete\";\n  const isRunning = statusType === \"running\";\n  const isCancelled =\n    status?.type === \"incomplete\" && status.reason === \"cancelled\";\n\n  const Icon = statusIconMap[statusType];\n  const label = isCancelled ? \"Cancelled tool\" : \"Used tool\";\n\n  return (\n    <CollapsibleTrigger\n      data-slot=\"tool-fallback-trigger\"\n      className={cn(\n        \"aui-tool-fallback-trigger group/trigger flex w-full items-center gap-2 px-4 text-sm transition-colors\",\n        className,\n      )}\n      {...props}\n    >\n      <Icon\n        data-slot=\"tool-fallback-trigger-icon\"\n        className={cn(\n          \"aui-tool-fallback-trigger-icon size-4 shrink-0\",\n          isCancelled && \"text-muted-foreground\",\n          isRunning && \"animate-spin\",\n        )}\n      />\n      <span\n        data-slot=\"tool-fallback-trigger-label\"\n        className={cn(\n          \"aui-tool-fallback-trigger-label-wrapper relative inline-block grow text-left leading-none\",\n          isCancelled && \"text-muted-foreground line-through\",\n        )}\n      >\n        <span>\n          {label}: <b>{toolName}</b>\n        </span>\n        {isRunning && (\n          <span\n            aria-hidden\n            data-slot=\"tool-fallback-trigger-shimmer\"\n            className=\"aui-tool-fallback-trigger-shimmer shimmer pointer-events-none absolute inset-0 motion-reduce:animate-none\"\n          >\n            {label}: <b>{toolName}</b>\n          </span>\n        )}\n      </span>\n      <ChevronDownIcon\n        data-slot=\"tool-fallback-trigger-chevron\"\n        className={cn(\n          \"aui-tool-fallback-trigger-chevron size-4 shrink-0\",\n          \"transition-transform duration-(--animation-duration) ease-out\",\n          \"group-data-[state=closed]/trigger:-rotate-90\",\n          \"group-data-[state=open]/trigger:rotate-0\",\n        )}\n      />\n    </CollapsibleTrigger>\n  );\n}\n\nfunction ToolFallbackContent({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof CollapsibleContent>) {\n  return (\n    <CollapsibleContent\n      data-slot=\"tool-fallback-content\"\n      className={cn(\n        \"aui-tool-fallback-content relative overflow-hidden text-sm outline-none\",\n        \"group/collapsible-content ease-out\",\n        \"data-[state=closed]:animate-collapsible-up\",\n        \"data-[state=open]:animate-collapsible-down\",\n        \"data-[state=closed]:fill-mode-forwards\",\n        \"data-[state=closed]:pointer-events-none\",\n        \"data-[state=open]:duration-(--animation-duration)\",\n        \"data-[state=closed]:duration-(--animation-duration)\",\n        className,\n      )}\n      {...props}\n    >\n      <div className=\"mt-3 flex flex-col gap-2 border-t pt-2\">{children}</div>\n    </CollapsibleContent>\n  );\n}\n\nfunction ToolFallbackArgs({\n  argsText,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  argsText?: string;\n}) {\n  if (!argsText) return null;\n\n  return (\n    <div\n      data-slot=\"tool-fallback-args\"\n      className={cn(\"aui-tool-fallback-args px-4\", className)}\n      {...props}\n    >\n      <pre className=\"aui-tool-fallback-args-value whitespace-pre-wrap\">\n        {argsText}\n      </pre>\n    </div>\n  );\n}\n\nfunction ToolFallbackResult({\n  result,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  result?: unknown;\n}) {\n  if (result === undefined) return null;\n\n  return (\n    <div\n      data-slot=\"tool-fallback-result\"\n      className={cn(\n        \"aui-tool-fallback-result border-t border-dashed px-4 pt-2\",\n        className,\n      )}\n      {...props}\n    >\n      <p className=\"aui-tool-fallback-result-header font-semibold\">Result:</p>\n      <pre className=\"aui-tool-fallback-result-content whitespace-pre-wrap\">\n        {typeof result === \"string\" ? result : JSON.stringify(result, null, 2)}\n      </pre>\n    </div>\n  );\n}\n\nfunction ToolFallbackError({\n  status,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  status?: ToolCallMessagePartStatus;\n}) {\n  if (status?.type !== \"incomplete\") return null;\n\n  const error = status.error;\n  const errorText = error\n    ? typeof error === \"string\"\n      ? error\n      : JSON.stringify(error)\n    : null;\n\n  if (!errorText) return null;\n\n  const isCancelled = status.reason === \"cancelled\";\n  const headerText = isCancelled ? \"Cancelled reason:\" : \"Error:\";\n\n  return (\n    <div\n      data-slot=\"tool-fallback-error\"\n      className={cn(\"aui-tool-fallback-error px-4\", className)}\n      {...props}\n    >\n      <p className=\"aui-tool-fallback-error-header font-semibold text-muted-foreground\">\n        {headerText}\n      </p>\n      <p className=\"aui-tool-fallback-error-reason text-muted-foreground\">\n        {errorText}\n      </p>\n    </div>\n  );\n}\n\nconst ToolFallbackImpl: ToolCallMessagePartComponent = ({\n  toolName,\n  argsText,\n  result,\n  status,\n}) => {\n  const isCancelled =\n    status?.type === \"incomplete\" && status.reason === \"cancelled\";\n\n  return (\n    <ToolFallbackRoot\n      className={cn(isCancelled && \"border-muted-foreground/30 bg-muted/30\")}\n    >\n      <ToolFallbackTrigger toolName={toolName} status={status} />\n      <ToolFallbackContent>\n        <ToolFallbackError status={status} />\n        <ToolFallbackArgs\n          argsText={argsText}\n          className={cn(isCancelled && \"opacity-60\")}\n        />\n        {!isCancelled && <ToolFallbackResult result={result} />}\n      </ToolFallbackContent>\n    </ToolFallbackRoot>\n  );\n};\n\nconst ToolFallback = memo(\n  ToolFallbackImpl,\n) as unknown as ToolCallMessagePartComponent & {\n  Root: typeof ToolFallbackRoot;\n  Trigger: typeof ToolFallbackTrigger;\n  Content: typeof ToolFallbackContent;\n  Args: typeof ToolFallbackArgs;\n  Result: typeof ToolFallbackResult;\n  Error: typeof ToolFallbackError;\n};\n\nToolFallback.displayName = \"ToolFallback\";\nToolFallback.Root = ToolFallbackRoot;\nToolFallback.Trigger = ToolFallbackTrigger;\nToolFallback.Content = ToolFallbackContent;\nToolFallback.Args = ToolFallbackArgs;\nToolFallback.Result = ToolFallbackResult;\nToolFallback.Error = ToolFallbackError;\n\nexport {\n  ToolFallback,\n  ToolFallbackRoot,\n  ToolFallbackTrigger,\n  ToolFallbackContent,\n  ToolFallbackArgs,\n  ToolFallbackResult,\n  ToolFallbackError,\n};\n",
      "type": "registry:component",
      "path": "components/assistant-ui/tool-fallback.tsx"
    }
  ],
  "dependencies": [
    "@assistant-ui/react",
    "lucide-react"
  ],
  "registryDependencies": [
    "collapsible"
  ]
}