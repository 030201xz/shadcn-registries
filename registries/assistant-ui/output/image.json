{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "image",
  "type": "registry:component",
  "files": [
    {
      "content": "\"use client\";\n\nimport {\n  memo,\n  useState,\n  useEffect,\n  useRef,\n  type PropsWithChildren,\n} from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { ImageIcon, ImageOffIcon } from \"lucide-react\";\nimport type { ImageMessagePartComponent } from \"@assistant-ui/react\";\nimport { cn } from \"@/lib/utils\";\n\nconst imageVariants = cva(\n  \"aui-image-root relative overflow-hidden rounded-lg\",\n  {\n    variants: {\n      variant: {\n        outline: \"border border-border\",\n        ghost: \"\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        sm: \"max-w-64\",\n        default: \"max-w-96\",\n        lg: \"max-w-[512px]\",\n        full: \"w-full\",\n      },\n    },\n    defaultVariants: {\n      variant: \"outline\",\n      size: \"default\",\n    },\n  },\n);\n\nexport type ImageRootProps = React.ComponentProps<\"div\"> &\n  VariantProps<typeof imageVariants>;\n\nfunction ImageRoot({\n  className,\n  variant,\n  size,\n  children,\n  ...props\n}: ImageRootProps) {\n  return (\n    <div\n      data-slot=\"image-root\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(imageVariants({ variant, size, className }))}\n      {...props}\n    >\n      {children}\n    </div>\n  );\n}\n\ntype ImagePreviewProps = Omit<React.ComponentProps<\"img\">, \"children\"> & {\n  containerClassName?: string;\n};\n\nfunction ImagePreview({\n  className,\n  containerClassName,\n  onLoad,\n  onError,\n  alt = \"Image content\",\n  src,\n  ...props\n}: ImagePreviewProps) {\n  const imgRef = useRef<HTMLImageElement>(null);\n  const [loadedSrc, setLoadedSrc] = useState<string | undefined>(undefined);\n  const [errorSrc, setErrorSrc] = useState<string | undefined>(undefined);\n\n  const loaded = loadedSrc === src;\n  const error = errorSrc === src;\n\n  useEffect(() => {\n    if (\n      typeof src === \"string\" &&\n      imgRef.current?.complete &&\n      imgRef.current.naturalWidth > 0\n    ) {\n      setLoadedSrc(src);\n    }\n  }, [src]);\n\n  return (\n    <div\n      data-slot=\"image-preview\"\n      className={cn(\"relative min-h-32\", containerClassName)}\n    >\n      {!loaded && !error && (\n        <div\n          data-slot=\"image-preview-loading\"\n          className=\"absolute inset-0 flex items-center justify-center bg-muted/50\"\n        >\n          <ImageIcon className=\"size-8 animate-pulse text-muted-foreground\" />\n        </div>\n      )}\n      {error ? (\n        <div\n          data-slot=\"image-preview-error\"\n          className=\"flex min-h-32 items-center justify-center bg-muted/50 p-4\"\n        >\n          <ImageOffIcon className=\"size-8 text-muted-foreground\" />\n        </div>\n      ) : (\n        <img\n          ref={imgRef}\n          src={src}\n          alt={alt}\n          className={cn(\n            \"block h-auto w-full object-contain\",\n            !loaded && \"invisible\",\n            className,\n          )}\n          onLoad={(e) => {\n            if (typeof src === \"string\") setLoadedSrc(src);\n            onLoad?.(e);\n          }}\n          onError={(e) => {\n            if (typeof src === \"string\") setErrorSrc(src);\n            onError?.(e);\n          }}\n          {...props}\n        />\n      )}\n    </div>\n  );\n}\n\nfunction ImageFilename({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"span\">) {\n  if (!children) return null;\n\n  return (\n    <span\n      data-slot=\"image-filename\"\n      className={cn(\n        \"block truncate px-2 py-1.5 text-muted-foreground text-xs\",\n        className,\n      )}\n      {...props}\n    >\n      {children}\n    </span>\n  );\n}\n\ntype ImageZoomProps = PropsWithChildren<{\n  src: string;\n  alt?: string;\n}>;\n\nfunction ImageZoom({ src, alt = \"Image preview\", children }: ImageZoomProps) {\n  const [isMounted, setIsMounted] = useState(false);\n  const [isOpen, setIsOpen] = useState(false);\n\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  const handleOpen = () => setIsOpen(true);\n  const handleClose = () => setIsOpen(false);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") setIsOpen(false);\n    };\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, [isOpen]);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    const originalOverflow = document.body.style.overflow;\n    document.body.style.overflow = \"hidden\";\n    return () => {\n      document.body.style.overflow = originalOverflow;\n    };\n  }, [isOpen]);\n\n  return (\n    <>\n      <div\n        onClick={handleOpen}\n        onKeyDown={(e) => e.key === \"Enter\" && handleOpen()}\n        role=\"button\"\n        tabIndex={0}\n        className=\"aui-image-zoom-trigger cursor-zoom-in\"\n        aria-label=\"Click to zoom image\"\n      >\n        {children}\n      </div>\n      {isMounted &&\n        isOpen &&\n        createPortal(\n          <div\n            data-slot=\"image-zoom-overlay\"\n            role=\"button\"\n            tabIndex={0}\n            className=\"aui-image-zoom-overlay fade-in fixed inset-0 z-50 flex animate-in items-center justify-center bg-black/80 duration-200\"\n            onClick={handleClose}\n            onKeyDown={(e) => e.key === \"Enter\" && handleClose()}\n            aria-label=\"Close zoomed image\"\n          >\n            <img\n              data-slot=\"image-zoom-content\"\n              src={src}\n              alt={alt}\n              className=\"aui-image-zoom-content fade-in zoom-in-95 max-h-[90vh] max-w-[90vw] animate-in cursor-zoom-out object-contain duration-200\"\n              onClick={(e) => {\n                e.stopPropagation();\n                handleClose();\n              }}\n            />\n          </div>,\n          document.body,\n        )}\n    </>\n  );\n}\n\nconst ImageImpl: ImageMessagePartComponent = ({ image, filename }) => {\n  return (\n    <ImageRoot>\n      <ImageZoom src={image} alt={filename || \"Image content\"}>\n        <ImagePreview src={image} alt={filename || \"Image content\"} />\n      </ImageZoom>\n      <ImageFilename>{filename}</ImageFilename>\n    </ImageRoot>\n  );\n};\n\nconst Image = memo(ImageImpl) as unknown as ImageMessagePartComponent & {\n  Root: typeof ImageRoot;\n  Preview: typeof ImagePreview;\n  Filename: typeof ImageFilename;\n  Zoom: typeof ImageZoom;\n};\n\nImage.displayName = \"Image\";\nImage.Root = ImageRoot;\nImage.Preview = ImagePreview;\nImage.Filename = ImageFilename;\nImage.Zoom = ImageZoom;\n\nexport {\n  Image,\n  ImageRoot,\n  ImagePreview,\n  ImageFilename,\n  ImageZoom,\n  imageVariants,\n};\n",
      "type": "registry:component",
      "path": "components/assistant-ui/image.tsx"
    }
  ],
  "dependencies": [
    "@assistant-ui/react",
    "lucide-react",
    "class-variance-authority"
  ],
  "registryDependencies": []
}